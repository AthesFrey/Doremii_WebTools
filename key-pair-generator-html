<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Base64URL-X25519-KEYS</title>

  <script src="/wp-content/uploads/tweetnacl-fast-1.0.3.min.js"></script>
  <script defer src="/wp-content/uploads/x25519-keygen.js?v=20251218B5"></script>

  <style>
    :root{
      --maxw:520px;
      --accent:#ff7a00;
      --bg:#fffaf2;
      --card:#ffffff;
      --text:#1f2328;
      --muted:#6b7280;
      --mono-bg:#fff2df;
      --r:18px;
      --btnh:38px;
      --shadow:0 10px 30px rgba(0,0,0,.10);
      --font:system-ui,-apple-system,Segoe UI,Roboto,Arial,"PingFang SC","Microsoft YaHei",sans-serif;
      --mono:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace;
    }

    body{margin:0;background:var(--bg);color:var(--text);font-family:var(--font);}
    .wrap{max-width:var(--maxw);margin:0 auto;padding:14px 12px 20px;box-sizing:border-box;}
    h2{margin:0 0 10px;text-align:center;font-size:20px;font-weight:800;letter-spacing:.2px;}
    .sub{margin:0 0 12px;text-align:center;color:var(--muted);font-size:13px;line-height:1.55;}

    /* 卡片 + 外侧羽化（关键：before 的模糊渐变） */
    .shell{position:relative;border-radius:calc(var(--r) + 6px);}
    .shell:before{
      content:"";
      position:absolute;inset:-18px;
      border-radius:calc(var(--r) + 20px);
      background:
        radial-gradient(closest-side, rgba(255,122,0,.22), rgba(255,122,0,0) 70%),
        radial-gradient(closest-side, rgba(30,58,138,.10), rgba(30,58,138,0) 72%);
      filter:blur(16px);
      opacity:.95;
      z-index:-1;
      pointer-events:none;
    }

    .card{
      background:var(--card);
      border:1px solid rgba(0,0,0,.04);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:18px;
      box-sizing:border-box;
    }

    .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-top:10px;}
    .label{min-width:88px;color:var(--muted);font-size:13px;}
    .field,.out{
      flex:1 1 260px;min-width:0;
      height:var(--btnh);
      border-radius:999px;
      box-sizing:border-box;
      font-family:var(--mono);
      font-size:13px;
      line-height:1.2;
    }
    .field{
      border:1px solid rgba(255,122,0,.30);
      background:var(--mono-bg);
      padding:0 12px;
      outline:none;
    }
    .field:focus{border-color:var(--accent);}
    .out{
      display:flex;align-items:center;
      background:var(--mono-bg);
      padding:6px 12px;
      word-break:break-all;
      overflow-wrap:anywhere;
    }

    button{
      height:var(--btnh);
      padding:0 14px;
      border-radius:999px;
      border:1px solid transparent;
      font-size:13px;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
      transition:.12s ease;
    }
    .main{background:var(--accent);color:#fff;font-weight:800;box-shadow:0 8px 18px rgba(255,122,0,.22);}
    .ghost{background:#fff7eb;border-color:rgba(255,122,0,.35);color:#ff8a00;font-weight:800;}
    button:active{transform:translateY(1px);}

    /* 历史区：按 JS 生成的 x-hist-* 类名做样式，避免主题放大导致溢出 */
    #x-hist{
      margin-top:10px;
      background:rgba(255,122,0,.06);
      border:1px solid rgba(255,122,0,.16);
      border-radius:14px;
      padding:10px;
      box-sizing:border-box;
      font-size:12px;
      line-height:1.35;
    }
    .x-hist-row{display:flex;gap:10px;align-items:flex-start;padding:6px 2px;border-bottom:1px dashed rgba(0,0,0,.10);}
    .x-hist-row:last-child{border-bottom:none;}
    .x-hist-index{width:34px;flex:0 0 auto;color:var(--muted);font-size:12px;line-height:1.35;padding-top:1px;}
    .x-hist-text{
      flex:1 1 auto;min-width:0;
      font-family:var(--mono);
      font-size:12px;line-height:1.35;
      white-space:normal;
      overflow-wrap:anywhere;
      word-break:break-word;
      color:#222;
    }
    .x-hist-copy{
      height:28px;padding:0 10px;
      font-size:12px;border-radius:999px;
      background:#fff;border:1px solid rgba(0,0,0,.10);
      flex:0 0 auto;
    }
  </style>
</head>

<body>
  <main class="wrap">
    <h2>Base64URL-X25519-密钥生成器</h2>

    <section class="shell">
      <div class="card">
        <p class="sub">私钥：Base64URL（43 字符），公钥使用 X25519（<code>nacl.scalarMult.base</code>）推导。</p>

        <div class="row">
          <div class="label">操作</div>
          <button class="main" id="x-generate">Generate</button>
        </div>

        <div class="row">
          <div class="label">私钥→公钥</div>
          <input class="field" id="x-priv-input" type="text" placeholder="粘贴 43 字符 Base64URL 私钥（sk）"
                 autocomplete="off" autocapitalize="off" spellcheck="false" />
          <button class="ghost" id="x-calc-pub">Calc pk</button>
        </div>

        <div class="row">
          <div class="label">Private key</div>
          <div class="out" id="x-priv"></div>
          <button class="ghost" id="x-copy-priv">Copy</button>
        </div>

        <div class="row">
          <div class="label">Public key</div>
          <div class="out" id="x-pub"></div>
          <button class="ghost" id="x-copy-pub">Copy</button>
        </div>

        <div class="row" style="margin-top:14px;">
          <div class="label">results:</div>
        </div>
        <div id="x-hist"></div>
      </div>
    </section>
  </main>
</body>
</html>
